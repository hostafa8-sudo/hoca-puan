<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hoca Puanla</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .box { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 400px; }
        h2 { color: #1e88e5; text-align: center; }
        label { font-weight: bold; display: block; margin-top: 15px; color: #333; }
        select, textarea, button { width: 100%; padding: 12px; margin-top: 8px; border-radius: 8px; border: 1px solid #ddd; font-size: 15px; box-sizing: border-box; }
        textarea { height: 80px; resize: none; }
        button { background-color: #1e88e5; color: white; border: none; cursor: pointer; font-weight: bold; margin-top: 20px; transition: 0.2s; }
        button:hover { background-color: #1565c0; }
        .yorum-kart { background: #fff; border-left: 5px solid #1e88e5; padding: 15px; margin-top: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); width: 100%; max-width: 400px; }
        .puan-yildiz { color: #fbc02d; font-weight: bold; }
    </style>
</head>
<body>

<div class="box">
    <h2>ğŸ‘¨â€ğŸ« Hoca Puanla</h2>
    
    <label>Hoca SeÃ§:</label>
    <select id="hoca">
        <option>GÃœVEN HOCA</option>
        <option>HASAN HOCA</option>
        <option>CELAL HOCA</option>
        <option>ERDAL HOCA</option>
        <option>MERAL HOCA</option>
        <option>SELVÄ° HOCA</option>
        <option>EMÄ°NE HOCA</option>
        <option>CEMÄ°LE HOCA</option>
    </select>

    <label>Puan:</label>
    <select id="puan">
        <option value="5">â­â­â­â­â­ (5)</option>
        <option value="4">â­â­â­â­ (4)</option>
        <option value="3">â­â­â­ (3)</option>
        <option value="2">â­â­ (2)</option>
        <option value="1">â­ (1)</option>
    </select>

    <label>Yorumun:</label>
    <textarea id="yorum" placeholder="Hoca hakkÄ±nda ne dÃ¼ÅŸÃ¼nÃ¼yorsun?"></textarea>
    
    <button onclick="gonder()">PuanÄ± GÃ¶nder</button>
</div>

<div id="liste">
    </div>

<script>
    // --- SUPABASE AYARLARI ---
    // Buradaki tÄ±rnak iÃ§lerini Supabase Settings > API kÄ±smÄ±ndaki bilgilerle doldur!
    const URL = "https://pcciifqxutljwmqdzmae.supabase.co"; 
    const KEY = "sb_publishable_QXpcQl5WKUHhPBTAzzDX4A_PM932FTa";
    const supabaseClient = supabase.createClient(URL, KEY);

    // --- VERÄ° GÃ–NDERME ---
    async function gonder() {
        const hocaAdi = document.getElementById('hoca').value;
        const yorumMetni = document.getElementById('yorum').value;
        const puanDegeri = document.getElementById('puan').value;

        if(!yorumMetni) return alert("LÃ¼tfen bir yorum yaz!");

        const { error } = await supabaseClient
            .from('yorumlar') // Tablo isminin 'yorumlar' olduÄŸundan emin ol
            .insert([{ hoca_adi: hocaAdi, yorum_metni: yorumMetni, puan: parseInt(puanDegeri) }]);

        if (error) {
            alert("Hata oluÅŸtu: " + error.message);
        } else {
            alert("PuanÄ±n baÅŸarÄ±yla kaydedildi!");
            document.getElementById('yorum').value = "";
            yorumlariGetir(); // Listeyi yenile
        }
    }

    // --- VERÄ°LERÄ° LÄ°STELEME ---
    async function yorumlariGetir() {
        const listeDiv = document.getElementById('liste');
        
        const { data, error } = await supabaseClient
            .from('yorumlar')
            .select('*')
            .order('id', { ascending: false });

        if (error) {
            listeDiv.innerHTML = "<p>Veriler yÃ¼klenirken hata oluÅŸtu.</p>";
        } else {
            listeDiv.innerHTML = "";
            data.forEach(y => {
                listeDiv.innerHTML += `
                    <div class="yorum-kart">
                        <strong>${y.hoca_adi}</strong> 
                        <span class="puan-yildiz"> | ${'â­'.repeat(y.puan)}</span>
                        <p>${y.yorum_metni}</p>
                    </div>`;
            });
        }
    }

    // Sayfa aÃ§Ä±ldÄ±ÄŸÄ±nda yorumlarÄ± otomatik yÃ¼kle
    yorumlariGetir();
</script>

</body>
</html>

